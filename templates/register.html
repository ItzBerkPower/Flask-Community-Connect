{% extends "layout.html" %}
{% block title %}Sign Up | Community Connect{% endblock %}

{% block content %}
<div class="bubble-container">
    <div class="bubble">
        <h2 class="text-center mb-4">Create an Account</h2>

        <form method="POST">
            <!-- Role selection -->
            <div class="mb-3">
                <label for="role" class="form-label">Sign Up As</label>
                <select class="form-select" id="role" name="role" required onchange="toggleFields()">
                    <option value="">-- Select Role --</option>
                    <option value="volunteer">Volunteer</option>
                    <option value="organisation">Organisation</option>
                </select>
            </div>

            <!-- Shared fields -->
            <div class="mb-3">
                <input type="email" class="form-control" name="email" placeholder="Email Address" required>
            </div>
            <div class="mb-3">
                <input type="password" class="form-control" name="password" placeholder="Password" required>
            </div>

            <!-- Volunteer fields -->
            <div id="volunteer-fields" style="display:none;">
                <div class="mb-3">
                    <input type="text" class="form-control" name="first_name" placeholder="First Name" required>
                </div>
                <div class="mb-3">
                    <input type="text" class="form-control" name="last_name" placeholder="Last Name" required>
                </div>
                <div class="mb-3">
                    <label for="dob" class="form-label">Date of Birth</label>
                    <input type="date" class="form-control" name="dob" required>
                </div>
            </div>

            <!-- Organisation fields -->
            <div id="organisation-fields" style="display:none;">
                <div class="mb-3">
                    <input type="text" class="form-control" name="organisation_name" placeholder="Organisation Name" required>
                </div>
                <div class="mb-3">
                    <textarea class="form-control" name="organisation_description" placeholder="Organisation Description"></textarea>
                </div>
                <div class="mb-3">
                    <input type="text" class="form-control" name="organisation_address" placeholder="Organisation Address">
                </div>
            </div>

            <button type="submit" class="btn btn-custom w-100">Sign Up</button>
        </form>
    </div>
</div>

<script>
function toggleFields() {
    const role = document.getElementById("role").value;
    const volunteerFields = document.getElementById("volunteer-fields");
    const orgFields = document.getElementById("organisation-fields");

    // Show/hide sections
    volunteerFields.style.display = (role === "volunteer") ? "block" : "none";
    orgFields.style.display = (role === "organisation") ? "block" : "none";

    // Dynamically set required attribute
    volunteerFields.querySelectorAll("input").forEach(i => i.required = (role === "volunteer"));
    orgFields.querySelectorAll("input, textarea").forEach(i => i.required = (role === "organisation" && i.name === "organisation_name"));
}
</script>
{% endblock %}
